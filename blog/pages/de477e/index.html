<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>web 应用 | VuePress标题</title>
    <meta name="generator" content="VuePress 1.9.7">
    <!-- <link rel="stylesheet" href="https://cdn.staticfile.org/element-ui/2.15.9/theme-chalk/index.min.css"> -->
    <link rel="shortcut icon" href="/blog/local/images/favicon.ico">
    <meta name="description" content="网站的描述">
    
    <link rel="preload" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/css/0.styles.7f4f6c6b.css" as="style"><link rel="preload" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/app.98c4adf1.js" as="script"><link rel="preload" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/2.68668fba.js" as="script"><link rel="preload" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/3.27dd3a65.js" as="script"><link rel="preload" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/222.3d628e3e.js" as="script"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/10.4a2d6888.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/100.7701eb82.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/101.ca18e82a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/102.aacd09cd.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/103.46d399fc.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/104.0dc8bed7.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/105.98d40ce8.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/106.47c5ff88.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/107.60d0bede.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/108.261a3150.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/109.a812b2e5.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/11.3d842c99.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/110.bfedc509.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/111.e2f3a3aa.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/112.1fff715b.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/113.b84f2fa1.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/114.85fe70bf.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/115.ed1eac56.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/116.116f91a6.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/117.371c7c0c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/118.3a341fe6.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/119.0534f758.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/12.e841ad86.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/120.eebb2e85.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/121.64760271.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/122.7ef138cc.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/123.132e1a69.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/124.2476995a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/125.2cf87ed4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/126.dbdcc213.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/127.f9bb4d01.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/128.3c239d9c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/129.71f2f5e2.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/13.a6cd487f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/130.7b377e6e.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/131.067dd0e4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/132.65f4de21.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/133.76f79c40.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/134.16cbde02.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/135.3e7b34d7.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/136.82a1c12f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/137.c6ea4d01.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/138.16e4fba2.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/139.4a17fc51.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/14.906643b1.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/140.ae540b28.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/141.d6dd242d.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/142.60365d08.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/143.8c6eb79a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/144.19251c73.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/145.035e571c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/146.197458c2.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/147.33735392.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/148.22fc1c75.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/149.85d8d9db.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/15.7b235c18.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/150.1ccbd0ba.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/151.48e1182f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/152.2ccce570.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/153.69f0a798.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/154.370a4de9.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/155.e5e80d5a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/156.e57bef90.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/157.a0bc1476.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/158.1e02d2b8.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/159.fadcf11c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/16.b6c16074.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/160.a7790ccf.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/161.175c27e7.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/162.f584c49f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/163.5f665410.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/164.8a3ccd22.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/165.af0a1140.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/166.f0b22510.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/167.2fa6c6c8.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/168.1c5d8d81.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/169.8206fd61.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/17.d4478cac.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/170.661bdf12.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/171.dd4dd0f1.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/172.1b5287c5.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/173.dfcb86a5.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/174.923112a2.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/175.90b15e56.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/176.11dd8341.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/177.6804da8a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/178.b53a1881.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/179.ae71f0ab.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/18.332924a0.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/180.f83e1d93.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/181.9ab07964.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/182.e7667725.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/183.584a91b8.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/184.d87cb29f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/185.176a2581.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/186.d0127e21.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/187.a64beada.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/188.7db5055e.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/189.18497168.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/19.fefba46a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/190.579007de.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/191.83b4601c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/192.46ab6e6e.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/193.8c6167cc.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/194.af73e231.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/195.e06600f4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/196.f5a8b208.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/197.dd1ce85c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/198.d726af89.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/199.cf8d8494.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/20.b2cac437.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/200.84b7d24c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/201.556c7f3f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/202.54204e56.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/203.83bfca28.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/204.e1797fb6.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/205.c1bca55f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/206.a2a0d9dd.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/207.00a41013.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/208.c1e82ea8.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/209.d111e6a3.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/21.fbb5ddea.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/210.142cfb92.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/211.6d8cf7d5.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/212.2fd2889f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/213.e3f0c8c9.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/214.0971bb95.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/215.377b9614.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/216.cd1b7309.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/217.ea704b94.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/218.f73fce10.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/219.3ab344e4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/22.1ce3b6b7.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/220.61c6fb41.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/221.ad95157f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/223.87160cd3.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/224.70898b64.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/225.c52105f0.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/226.9aaa5996.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/227.eab6d3c8.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/228.1127fee2.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/229.00026547.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/23.96c70dbd.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/230.62b45982.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/231.9bb72276.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/232.44d8c3d9.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/233.722e33c3.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/234.54cfea37.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/235.6a68877c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/236.560e1117.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/237.b10a7dc3.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/238.fade9972.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/239.1e956a3c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/24.441ede79.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/240.11a426b1.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/241.612c03e7.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/242.834f8eb6.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/243.957ccc92.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/244.5a0e4902.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/245.975d8649.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/246.890c62b9.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/247.45f0e935.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/248.1a841c31.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/249.c6b0141e.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/25.afaa9699.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/250.a7c39079.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/251.79ee385d.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/252.1328a0f4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/253.69248c0d.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/254.cfe18203.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/255.f150843a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/256.d22a6fb4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/257.9018f9fb.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/258.508aa626.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/259.e704d1cd.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/26.0eb040fc.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/260.90901638.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/261.d9e7dd84.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/262.f284e235.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/263.40342021.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/264.5bead40d.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/265.b9d6cb1f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/266.577a99d1.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/267.8bbf7d04.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/268.3d9c3fed.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/269.63b3cbd0.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/27.a524e7fb.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/270.f57c3b45.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/271.5d5ece0d.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/272.04d63978.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/273.83b02990.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/274.a9ba62ca.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/275.f22341fb.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/276.08ccb5cc.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/277.974a651d.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/278.e13269f8.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/279.5f6ee01a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/28.1dae3efd.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/280.551164f6.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/281.6fa44d9a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/282.535dc3aa.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/283.6a876f87.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/284.72adea43.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/285.1bbb8f0f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/286.8216cb8a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/287.c0b981e3.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/288.37da8b3d.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/289.a1af0c9f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/29.4ff88886.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/290.3b3522d0.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/291.53e60429.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/292.7e4b1a29.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/293.6ae7d65c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/30.97300bb7.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/31.ef4ab674.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/32.59fc82d4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/33.9fc6cbd6.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/34.b361b477.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/35.6bd439a7.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/36.8c8de35c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/37.55064930.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/38.3e9c11f4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/39.2a11679e.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/4.aa43d339.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/40.29a80a94.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/41.c3f0dfa4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/42.6a78ca43.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/43.4b65c22a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/44.4688716f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/45.f0fd7815.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/46.30fd66f4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/47.f04b1a83.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/48.f5d3b7b3.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/49.febf2768.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/5.6047bf1e.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/50.bd87e7a4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/51.f401f128.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/52.d2784b10.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/53.440fb6bc.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/54.04b251b3.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/55.4555d975.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/56.b4b1cfcf.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/57.747a180d.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/58.1a89335b.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/59.4a9443ed.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/6.fe46b52b.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/60.b9fee773.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/61.2aabf7eb.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/62.ba30d47b.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/63.30953e6c.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/64.286493c2.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/65.87621125.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/66.638898ac.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/67.ac7795eb.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/68.cae13126.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/69.67905b0a.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/7.d610cd93.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/70.9e820ad3.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/71.4bdf5767.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/72.2a3ae972.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/73.f37067a4.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/74.f97627eb.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/75.dd85bded.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/76.69e3dfb0.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/77.f9a7e89d.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/78.f16076f5.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/79.194659eb.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/8.a177e984.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/80.8acb35c3.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/81.36a67a86.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/82.7bfa6019.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/83.eea38036.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/84.b2523633.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/85.67e2d32e.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/86.3f90b78f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/87.c1006361.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/88.88252d07.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/89.26749514.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/9.59aa3120.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/90.424fa1c2.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/91.bced0fd9.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/92.38d83ff9.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/93.6934069f.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/94.d820e2a9.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/95.85e6a809.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/96.2b02fe13.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/97.c447561b.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/98.ef796913.js"><link rel="prefetch" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/99.1f14c127.js">
    <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/css/0.styles.7f4f6c6b.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/local/images/logo.png" alt="VuePress标题" class="logo"> <span class="site-name can-hide">VuePress标题</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><a href="/blog/web/" class="link-title">前端基础</a> <span class="title" style="display:none;">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/e515ef/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/d5d654/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/13753f/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/3355f7/" class="nav-link">ES6</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/bc99e2/" class="nav-link">Web API</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战进阶" class="dropdown-title"><a href="/blog/advanced/" class="link-title">实战进阶</a> <span class="title" style="display:none;">实战进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/cd2bf6/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/7468c4/" class="nav-link">NodeJS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计科储备" class="dropdown-title"><a href="/blog/cst/" class="link-title">计科储备</a> <span class="title" style="display:none;">计科储备</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/986dd9/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/f05e52/" class="nav-link">排序算法</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/401e85/" class="nav-link">网络基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="通用技能" class="dropdown-title"><a href="/blog/universal/" class="link-title">通用技能</a> <span class="title" style="display:none;">通用技能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/b3cd00/" class="nav-link">编码实践</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/121734/" class="nav-link">版本管理(Git)</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/c71511/" class="nav-link">版本管理(Svn)</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/302464/" class="nav-link">Markdown</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文章索引" class="dropdown-title"><a href="/blog/categories/" class="link-title">文章索引</a> <span class="title" style="display:none;">文章索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/songlitao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><a href="/blog/web/" class="link-title">前端基础</a> <span class="title" style="display:none;">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/e515ef/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/d5d654/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/13753f/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/3355f7/" class="nav-link">ES6</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/bc99e2/" class="nav-link">Web API</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战进阶" class="dropdown-title"><a href="/blog/advanced/" class="link-title">实战进阶</a> <span class="title" style="display:none;">实战进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/cd2bf6/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/7468c4/" class="nav-link">NodeJS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计科储备" class="dropdown-title"><a href="/blog/cst/" class="link-title">计科储备</a> <span class="title" style="display:none;">计科储备</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/986dd9/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/f05e52/" class="nav-link">排序算法</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/401e85/" class="nav-link">网络基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="通用技能" class="dropdown-title"><a href="/blog/universal/" class="link-title">通用技能</a> <span class="title" style="display:none;">通用技能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/b3cd00/" class="nav-link">编码实践</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/121734/" class="nav-link">版本管理(Git)</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/c71511/" class="nav-link">版本管理(Svn)</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/302464/" class="nav-link">Markdown</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文章索引" class="dropdown-title"><a href="/blog/categories/" class="link-title">文章索引</a> <span class="title" style="display:none;">文章索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/songlitao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>NodeJS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/pages/7468c4/" class="sidebar-link">1. 深入浅出 NodeJS</a></li><li><a href="/blog/pages/bb4e17/" class="sidebar-link">2. 语法</a></li><li><a href="/blog/pages/de477e/" aria-current="page" class="active sidebar-link">3. web 应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/blog/pages/de477e/#基本使用" class="sidebar-link">基本使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/de477e/#从-demo-到-http-协议" class="sidebar-link">从 demo 到 http 协议</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/de477e/#post-请求" class="sidebar-link">POST 请求</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/de477e/#querystring-处理" class="sidebar-link">querystring 处理</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/de477e/#post-内容为-json-格式" class="sidebar-link">post 内容为 JSON 格式</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/de477e/#总结" class="sidebar-link">总结</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog/pages/de477e/#url-参数处理" class="sidebar-link">url 参数处理</a></li><li class="sidebar-sub-header level2"><a href="/blog/pages/de477e/#路由" class="sidebar-link">路由</a></li><li class="sidebar-sub-header level2"><a href="/blog/pages/de477e/#cookie" class="sidebar-link">cookie</a></li><li class="sidebar-sub-header level2"><a href="/blog/pages/de477e/#上传文件" class="sidebar-link">上传文件</a></li><li class="sidebar-sub-header level2"><a href="/blog/pages/de477e/#框架" class="sidebar-link">框架</a></li><li class="sidebar-sub-header level2"><a href="/blog/pages/de477e/#中间件" class="sidebar-link">中间件</a></li><li class="sidebar-sub-header level2"><a href="/blog/pages/de477e/#页面渲染" class="sidebar-link">页面渲染</a></li><li class="sidebar-sub-header level2"><a href="/blog/pages/de477e/#遗留问题" class="sidebar-link">遗留问题</a></li></ul></li><li><a href="/blog/pages/945605/" class="sidebar-link">4. 事件</a></li><li><a href="/blog/pages/4aa03d/" class="sidebar-link">5. Stream 和 Buffer</a></li><li><a href="/blog/pages/ca4b6e/" class="sidebar-link">6. 异步 IO</a></li><li><a href="/blog/pages/4deead/" class="sidebar-link">7. 进程</a></li><li><a href="/blog/pages/d21ea1/" class="sidebar-link">8. 其他</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/blog/" title="首页" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/blog/advanced/#实战进阶" data-v-06970110>实战进阶</a></li><li data-v-06970110><a href="/blog/advanced/#NodeJS" data-v-06970110>NodeJS</a></li></ul> <div class="info" data-v-06970110><div title="作者" class="author iconfont icon-touxiang" data-v-06970110><a href="https://github.com/songlitao" target="_blank" title="作者" class="beLink" data-v-06970110>songlitao</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2022-06-12</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">web 应用<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="web-应用"><a href="#web-应用" class="header-anchor">#</a> web 应用</h1> <p>web server 其实就是讲 server 如何处理 http 请求，因为所谓的 web 就是一个一个的 http 请求，server 端拿到请求信息、计算处理、最后返回。http 标准的内容比较多，本文只讲教程相关的部分，推荐看作者写的 <a href="https://github.com/wangfupeng1988/read-notes/blob/master/book/%E5%9B%BE%E8%A7%A3http.md" target="_blank" rel="noopener noreferrer">《图解 http》读书笔记<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 去全面了解 http —— 如果想最！最！最！全面了解，那只能去购买《http 权威指南》阅读了，厚厚的枕头书。</p> <h2 id="基本使用"><a href="#基本使用" class="header-anchor">#</a> 基本使用</h2> <h3 id="从-demo-到-http-协议"><a href="#从-demo-到-http-协议" class="header-anchor">#</a> 从 demo 到 http 协议</h3> <p>新建<code>demo1.js</code>，内容如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">serverCallback</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">'Content-type'</span><span class="token operator">:</span> <span class="token string">'text/html'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;hello nodejs&lt;/h1&gt;'</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>serverCallback<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
</code></pre></div><p>命令行运行<code>node demo1.js</code>，然后浏览器访问<code>http://localhost:8080/</code>（或者命令行<code>curl http://localhost:8080/</code>）即可看到结果。这一般是介绍 nodejs 入门的常用 demo ，熟悉 http 协议的同学都知道，这其实就是一个简单的 http 请求处理。</p> <p><code>req</code>即 request 即请求内容，demo 没有代码演示，下文会补充上。例如<code>req.method</code>可以获取请求的方法（如<code>GET</code> <code>POST</code>等），<code>req.headers</code>可获取请求的头，如<code>accept</code> <code>host</code> <code>user-agent</code>等。</p> <p><code>res</code>即 response 即返回内容，这是 http 请求最基本的内容。<code>res.writeHead</code>定义返回的头，包括返回状态码和头信息。<code>res.write</code>定义返回的内容，最后<code>res.end()</code>表示 server 端处理请求结束。</p> <blockquote><p>PS：这里不会专门讲解 http 协议的细节，不熟悉的同学请看看本文一开始推荐的博客和书籍</p></blockquote> <h3 id="post-请求"><a href="#post-请求" class="header-anchor">#</a> POST 请求</h3> <p>上述处理 get 请求比较简单，能体现 http 协议处理的地方也有限。接下来继续了解一下 nodejs 如何处理 post 请求。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">serverCallback</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> method <span class="token operator">=</span> req<span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取请求的方法</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>method <span class="token operator">===</span> <span class="token string">'get'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 省略 3 行，上文代码示例中处理 GET 请求的代码</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>method <span class="token operator">===</span> <span class="token string">'post'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 接收 post 请求的内容</span>
        <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token string">''</span>
        req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// “一点一点”接收内容</span>
            data <span class="token operator">+=</span> chunk<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 接收完毕，将内容输出</span>
            res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">'Content-type'</span><span class="token operator">:</span> <span class="token string">'text/html'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>serverCallback<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
</code></pre></div><p>以上代码即可接收和处理 post 请求，代码中<code>req.on('data' ...</code>和<code>req.on('end', ...</code>这里，我们作为遗留问题，后面会详细重点的讲解，因为这些也是 nodejs 的重要知识，必须学会的。这里你看下代码注释，只要先知道，post 过来的内容是“一点一点”接收的，然后待接受完再做处理，这样即可。</p> <p>可以命令行运行<code>curl -d &quot;a=100&amp;b=200&quot; &quot;http://localhost:8080/&quot;</code>发起一个 post 请求，其中<code>a=100&amp;b=200</code>是请求的主体内容。</p> <h3 id="querystring-处理"><a href="#querystring-处理" class="header-anchor">#</a> querystring 处理</h3> <p>以上 post 请求的内容格式是 querystring 形式的，即<code>key1=value1&amp;key2=value2&amp;key3=value3</code>这种，可以对代码进行改造，将这些数据结构化。</p> <p>第一，代码最上面加<code>var querystring = require('querystring')</code>，引入<code>querystring</code>模块，nodejs 自带的。第二，对<code>req.on('end', ...</code>的内容做如下修改：</p> <div class="language-js extra-class"><pre class="language-js"><code>req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// res.writeHead(200, {'Content-type': 'text/html'})</span>
    <span class="token comment">// res.write(data)</span>
    data <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment">// 结构化为 JSON 格式</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">'Content-type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">// 返回头，改为 JSON 格式</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// res 只能输出字符串或者 Buffer 类型，因此这里只能 JSON.stringify 之后再输出</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="post-内容为-json-格式"><a href="#post-内容为-json-格式" class="header-anchor">#</a> post 内容为 JSON 格式</h3> <p>以上 post 请求的内容格式是 querystring 形式，一般用于网页的<code>&lt;form&gt;</code>提交，打印<code>req.headers['content-type']</code>的值是<code>application/x-www-form-urlencoded</code>，即是<code>&lt;form&gt;</code>提交的方式 —— 虽然是用<code>curl</code>模拟的。</p> <p>而现在网页中数据提交大部分使用 ajax ，数据格式也改为了 JSON 格式，且看 nodejs 如何处理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">serverCallback</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> method <span class="token operator">=</span> req<span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> contentType <span class="token operator">=</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-type'</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>method <span class="token operator">===</span> <span class="token string">'post'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>contentType <span class="token operator">===</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 省略 N 行</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>contentType <span class="token operator">===</span> <span class="token string">'application/json'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token string">''</span>
            req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                data <span class="token operator">+=</span> chunk<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment">// post 的数据为 JSON 格式，因此直接可以转换为 JS 对象</span>
                res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">'Content-type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// res 只能输出字符串或者 Buffer 类型，因此这里只能 JSON.stringify 之后再输出</span>
                res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>serverCallback<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
</code></pre></div><p>可以使用<code>curl -l -H &quot;Content-type: application/json&quot; -X POST -d '{&quot;name&quot;:&quot;zhangsan&quot;,&quot;age&quot;:25}' http://localhost:8080/</code>发起 post 请求，并且规定格式为 JSON，内容即<code>{&quot;name&quot;:&quot;zhangsan&quot;,&quot;age&quot;:25}</code></p> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <p>之前学习其他后端语言可能没这么费劲，接触不到这么底层的 http 协议的操作，那是因为它们都已经做好了框架的封装，并不是它们真的不需要。通过 nodejs 学习一下 http 协议的具体操作也绝对是好事一桩，不要抱怨。</p> <p>另外，nodejs 虽然没有提供官方的 web 框架，但是也不会傻乎乎的在项目中直接写这么底层的代码，下文会介绍 nodejs 社区中非常成熟的 web 框架，到时候这些 http 协议的操作，也都有简单的 API 可使用。</p> <h2 id="url-参数处理"><a href="#url-参数处理" class="header-anchor">#</a> url 参数处理</h2> <p>通过<code>req.url</code>可以获得请求网址的完整内容，其中比较重要的就是：路由和参数。路由下文讲，先说参数的处理。</p> <p>完整的 url 肯定是字符串形式的，是非结构化的，要想结构化需要引入 nodejs 提供的<code>url</code>模块，即<code>var url = require('url')</code>，然后通过<code>var urlData = url.parse(req.url)</code>进行结构化。</p> <p>从结构化之后的数据中，通过<code>urlData.query</code>即可轻松拿到 url 参数。代码示例如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span>

<span class="token comment">// 处理 url 参数</span>
<span class="token keyword">function</span> <span class="token function">serverCallback</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> urlData <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token comment">// 结构化 url 内容，变为 JS 对象</span>
    <span class="token keyword">var</span> query <span class="token operator">=</span> urlData<span class="token punctuation">.</span>query
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>

    <span class="token comment">// ……</span>
<span class="token punctuation">}</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>serverCallback<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
</code></pre></div><p>但是得到的 url 参数还是字符串，非结构化的，不好处理。这里引用<code>var querystring = require('querystring')</code>，然后<code>query = querystring.parse(query)</code>即可了。完整代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> querystring <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span>

<span class="token comment">// 处理 url 参数</span>
<span class="token keyword">function</span> <span class="token function">serverCallback</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> urlData <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token comment">// 结构化 url 内容，变为 JS 对象</span>
    <span class="token keyword">var</span> query <span class="token operator">=</span> urlData<span class="token punctuation">.</span>query
    query <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>  <span class="token comment">// 结构化 query 内容，变为 JS 对象</span>

    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">'Content-type'</span><span class="token operator">:</span> <span class="token string">'text/html'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>serverCallback<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
</code></pre></div><p>使用<code>curl http://127.0.0.1:8080/?a=1&amp;b=2</code>即可看到结果。</p> <h2 id="路由"><a href="#路由" class="header-anchor">#</a> 路由</h2> <p>通过<code>urlData.query</code>可以获取 url 参数，通过<code>urlData.pathname</code>可以获取路由，代码如下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">serverCallback</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> urlData <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
    <span class="token keyword">var</span> pathname <span class="token operator">=</span> urlData<span class="token punctuation">.</span>pathname <span class="token comment">// 获取 url 路由</span>

    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">'Content-type'</span><span class="token operator">:</span> <span class="token string">'text/html'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>pathname<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>serverCallback<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
</code></pre></div><p>可以通过<code>curl curl http://127.0.0.1:8080/api/getname</code>来验证。</p> <p>这里演示比较简单，但是路由处理却是 web server 中非常重要而且应用场景非常复杂的模块，而且路由如何设计也非常重要。其复杂性可以总结以下几点（未考虑到的欢迎补充）：</p> <ul><li><strong>不同的 method</strong>：如针对<code>/api/getname</code>，get 方法请求和 post 方法请求，要能区分开来</li> <li><strong>不同的参数规则</strong>：如<code>/api/getname/:id</code>表示必须有<code>id</code>参数，<code>/api/getname(/:id)</code>表示<code>id</code>可有可无</li> <li><strong>层级关系</strong>：如<code>/api/getname</code>和<code>/api/setname</code>都有<code>api</code>这个层级，要能支持两者共享流程</li></ul> <p>（是很复杂吧？）因此，一般路由的处理，都会根据一个 web 框架选择比较成熟的路由库，如 <a href="https://www.npmjs.com/package/koa-router" target="_blank" rel="noopener noreferrer">koa-router<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</p> <p><strong>【以下为扩展内容】</strong></p> <p>路由设计，当下比较流行<code>RESTful API</code>的思想。简单说来，就是将每个 url 都当做一个独立的资源，通过 method 规定这次请求的操作方式，如<code>get</code> <code>post</code> <code>put</code> <code>delete</code>等。有点类似于 linux 将所有内容都抽象为文件，都符合标准输入输出。如下代码：</p> <div class="language-js extra-class"><pre class="language-js"><code>router
  <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'Hello World!'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/users/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span><span class="token string">'/users/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/users/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>RESTful API</code>设计思想给出了 API 设计的标准，前端数据请求也将因此而更加规整，后续肯定会慢慢推广普及开来。</p> <h2 id="cookie"><a href="#cookie" class="header-anchor">#</a> cookie</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">serverCallback</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'Content-type'</span><span class="token operator">:</span> <span class="token string">'text/html'</span><span class="token punctuation">,</span>
        <span class="token comment">// 'Set-Cookie': 'a=100'           // 设置单个值</span>
        <span class="token string-property property">'Set-Cookie'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'a=100'</span><span class="token punctuation">,</span> <span class="token string">'b=200'</span><span class="token punctuation">]</span>   <span class="token comment">// 这是多个值</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'hello nodejs'</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>serverCallback<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
</code></pre></div><p>以上代码演示了如何<code>Set-Cookie</code>，浏览器访问<code>http://localhost:8080/</code>之后，前端即存储了 cookie 。然后再次访问，看通过<code>req.headers.cookie</code>获取到 cookie 内容。</p> <p>cookie 的知识都是 http 协议的内容，这里几个 API 不足以涵盖，不熟悉的同学要去学习 http 协议的知识。cookie 是网络请求中非常重要的内容，必须掌握。</p> <p><strong>【扩展】</strong></p> <p>cookie 应用比较典型的场景是 —— 登录。而且，cookie 要结合 server 端的 session 才能完成整个登录的功能。这是一个比较复杂而且独立的场景，具体使用应该放在一个实战项目中讲解更为合适，这里不详细赘述。</p> <p>简单描述一下。前端通过登录表单将用户名和密码发送到 server 端，server 端如果验证成功，即通过<code>Set-Cookie</code>设置一个<code>cookie</code>值，如<code>session_id=xxxx</code>，并且设置 20分钟 有效期，以及<code>httpOnly</code>（前端 JS 不能访问）。以后每次网络请求，server 端都通过判断是否有<code>session_id</code>来确定用户是否登录，以及通过<code>session_id</code>的值，对应到内存中的一些数据，这些数据即 server 端未用户存储的信息。</p> <p>针对登录场景操作 cookie 和 session ，针对 web 框架有专门的工具供使用，不用自己手动写。例如 <a href="https://www.npmjs.com/package/koa-session" target="_blank" rel="noopener noreferrer">koa-session<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="上传文件"><a href="#上传文件" class="header-anchor">#</a> 上传文件</h2> <p>HTML 中普通表单和特殊表单的区别就在于是否有<code>&lt;file&gt;</code>标签。如果需要有<code>&lt;file&gt;</code>标签，就需要指定表单需求 <strong><code>enctype</code>为<code>multipart/form-data</code></strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/upload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multipart/form-data<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">...</span> <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span> <span class="token attr-name">...</span> <span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>nodejs 可判断<code>Content-type</code>值为<code>multipart/form-data</code>来确定是文件上传的请求。这是一个比较特殊的场景，特别是在互联网 web server 中，nodejs 用来做上传文件的接口是否合适还需论证。如果真的有地方需要用，推荐使用 <a href="https://www.npmjs.com/package/formidable" target="_blank" rel="noopener noreferrer">formidable<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 工具，比较简单。</p> <h2 id="框架"><a href="#框架" class="header-anchor">#</a> 框架</h2> <p>nodejs 的 web server 框架，比较常用的有 <a href="http://www.expressjs.com.cn/" target="_blank" rel="noopener noreferrer">express<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://koa.bootcss.com/" target="_blank" rel="noopener noreferrer">koa<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，两者使用起来差别不是特别大 —— 因为两者的作者是同一个人（或者同一个团队）。两者的不同如下：</p> <ul><li><strong>这对异步</strong>：koa 支持最新的 ES7 草案中<code>async/await</code>语法，express 还是用的 callback 形式</li> <li><strong>社区</strong>：express 社区更加完善，插件更多；koa 相对来说社区、插件都少一些，不过发展这些年了也能满足日常需求</li></ul> <p>如果项目要做选择，我会这么推荐：</p> <ul><li>中小型项目，允许尝试新技术、踩新坑，船小也好调头，推荐使用 koa</li> <li>大型项目，时间紧急，满足需求和稳定第一，那就使用 express</li></ul> <p>但是我们作为前端程序猿，两者必须都了解，不熟悉的同学至少要去官网看下文档，做几个 demo 玩一玩。</p> <h2 id="中间件"><a href="#中间件" class="header-anchor">#</a> 中间件</h2> <p>框架提供给开发者的便利的地方有：</p> <ul><li>封装<code>req</code>和<code>res</code>接口</li> <li>封装路由处理</li> <li>提供中间件机制</li></ul> <p>其中，中间件对于我们前端开发者来说，算是一个比较新的概念（虽然它早就存在）。简单说来，中间件就是将一次请求的处理拆分成许多小部分，分而治之。这样做完全符合开放封闭原则，可以复用也可以扩展。例如 express 的代码示例</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 没有挂载路径的中间件，应用的每个请求都会执行该中间件</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Time:'</span><span class="token punctuation">,</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 挂载至 /user/:id 的中间件，任何指向 /user/:id 的请求都会执行它</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Request Type:'</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 路由和句柄函数(中间件系统)，处理指向 /user/:id 的 GET 请求</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'USER'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>express 总结的中间件有以下几种：</p> <ul><li><strong>应用级中间件</strong> 公共功能的中间件，例如日志记录、获取公共数据</li> <li><strong>路由级中间件</strong> 针对路由不同功能的中间件，用于业务处理</li> <li><strong>错误处理中间件</strong> 用于捕获异常</li> <li><strong>内置中间件</strong> 最常用的中间件，例如<code>express.static</code>是 express 内置的中间件，用于返回静态文件</li> <li><strong>第三方中间件</strong> 一个框架要保证扩展性，肯定得支持第三方开发者贡献自己的代码</li></ul> <p>本文主要讲解 nodejs 基础知识，框架的内容不会详细介绍，可以自己去看文档。</p> <h2 id="页面渲染"><a href="#页面渲染" class="header-anchor">#</a> 页面渲染</h2> <p>nodejs 没有御用的模板引擎，这一点不像 php asp jsp 等，需要自己去选择，例如 artTemplate 。书中也简单讲解了实现一个模板引擎的逻辑，我之前了解过 vue 中模板的解析，因此对这块逻辑也不算陌生。另外，模板解析的逻辑，大概了解即可，也无需详细深入，毕竟是工具性的东西。这里先略过。</p> <p><strong>【扩展】Bigpipe</strong></p> <p>普通的页面渲染，即便是首屏渲染，也是拿到所有该拿的数据之后，一次性吐出给前端。<strong>而 Bigpipe 是将页面内容分成了多个部分（pagelet），然后分批逐步输出</strong>。</p> <p>首先，要向前端输出模板和接收 pagelet 的方法，其实就是一个 JS 方法，该方法接收 DOM 选择器和内容，然后将内容渲染到 DOM 节点中。接下来，server 端异步请求数据，然后分批输出到前端去渲染，如下代码。nodejs 异步请求是部分顺序的，因此下面两个异步，哪个先输出不知道——也无需知道，先查询出来的先输出即可。</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/profile'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">0</span>
    db<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">'sql1'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'&lt;script&gt;bigpipe.set(&quot;articles&quot;, &quot;'</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&quot;)&lt;/script&gt;'</span><span class="token punctuation">)</span>
        num<span class="token operator">++</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 结束请求</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">'sql2'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'&lt;script&gt;bigpipe.set(&quot;copyright&quot;, &quot;'</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&quot;)&lt;/script&gt;'</span><span class="token punctuation">)</span>
        num<span class="token operator">++</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 结束请求</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>这种多 pagelet 分批下发的方式，ajax 也可以办到。但是 ajax 每次都是一个独立的 http 请求，而 Bigpipe 共用相同的请求，开销十分小。</p> <h2 id="遗留问题"><a href="#遗留问题" class="header-anchor">#</a> 遗留问题</h2> <p>上文中，有一段<code>req.on('data' ...</code>和<code>req.on('end', ...</code>代码没有详细介绍，现在关注两点：</p> <ul><li><code>req.on</code>这里的<code>on</code>是特定的吗？</li> <li>这里的<code>data</code>和<code>end</code>是特定的吗？</li></ul> <p>下面将用两节内容讲解这两个疑问。</p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/6/12 09:31:49</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/pages/bb4e17/" class="prev">2. 语法</a></span> <span class="next"><a href="/blog/pages/945605/">4. 事件</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:hbsonglitao@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/songlitao" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
    Copyright © 2020-2022
    <span>songlitao | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script>
      (function(){
        // 通过重写 document.querySelector 方法解决开启 vuepress-plugin-smooth-scroll 定位中文hash报错问题
        document.querySelector2 = document.querySelector;
        document.querySelector = function(selectors){
          return document.querySelector2(decodeURIComponent(selectors));
        };
      })();
    </script>
    <script defer src="https://cdn.staticfile.org/vue/2.6.14/vue.min.js"></script>
    <!-- <script defer src="https://cdn.staticfile.org/element-ui/2.15.9/index.min.js"></script> -->
    <script src="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/app.98c4adf1.js" defer></script><script src="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/2.68668fba.js" defer></script><script src="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/3.27dd3a65.js" defer></script><script src="https://fastly.jsdelivr.net/gh/songlitao/picgo/resource/blog/assets/js/222.3d628e3e.js" defer></script>
  </body>
</html>
